<!DOCTYPE html>

<html lang="en">

<head>
    <title>yit</title>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css' rel='stylesheet' type='text/css'>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <script src="https://wzrd.in/standalone/buffer"></script>
    <script src="https://unpkg.com/ipfs-api@9.0.0/dist/index.js"
            integrity="sha384-5bXRcW9kyxxnSMbOoHzraqa7Z0PQWIao+cgeg327zit1hz5LZCEbIMx/LWKPReuB"
            crossorigin="anonymous">
    </script>
</head>

<body class="container">

<h1>Register Employee</h1>

<div class="table-responsive">
    <table class="table table-bordered">
        <tbody>
        <tr>
            <td>Name</td>
            <td><input type="text" id="employeeNameTextId"/></td>
        </tr>
        </tbody>
    </table>
</div>

<a href="#" id="registerEmployeeButtonId" class="btn btn-primary">Register</a>

<br><br><br>

<h1>View Employee</h1>

<div class="table-responsive">
    <table class="table table-bordered">
        <tbody>
        <tr>
            <td>Employee Code</td>
            <td><input type="text" id="employeeCodeTextId" /></td>
        </tr>
        </tbody>
    </table>
</div>

<a href="#" id="viewEmployeeButtonId" class="btn btn-primary">View</a>

<div class="table-responsive">
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Name</th>
            <th>Profile Ids</th>
            <th>Default Profile Id</th>
            <th>Status</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td id="retrievedEmployeeNameTextId">name</td>
            <td id="retrievedEmployeeProfileIdsTextId">profile ids</td>
            <td id="retrievedEmployeeDefaultProfileIdTextId">default profile id</td>
            <td id="retrievedEmployeeStatusTextId">status</td>
        </tr>
        </tbody>
    </table>
</div>

<br><br><br>

<h1>Create Profile</h1>

<div class="table-responsive">
    <table class="table table-bordered">
        <tbody>
        <tr>
            <td>Name</td>
            <td><input type="text" id="profileNameTextId" /></td>
        </tr>
        <tr>
            <td>Skills</td>
            <td>
                <div class="checkbox">
                    <label><input type="checkbox" id="checkBoxJavaId" value="0">Java</label>
                </div>
                <div class="checkbox">
                    <label><input type="checkbox" id="checkBoxJsId" value="1">JavaScript</label>
                </div>
                <div class="checkbox">
                    <label><input type="checkbox" id="checkBoxMySQLId" value="2">MySQL</label>
                </div>
                <div class="checkbox">
                    <label><input type="checkbox" id="checkBoxMongoId" value="3">Mongo</label>
                </div>
            </td>
        </tr>
        <tr>
            <td>Default Profile</td>
            <td><input type="checkbox" id="defaultProfileCheckId" value="3"></td>
        </tr>
        <tr>
            <td>CV</td>
            <td>
                <form action="/">
                    <fieldset>
                        <input type="file" name="cvInputName" id="cvInputId">
                        <button type="button" onclick="upload()">Upload CV</button>
                    </fieldset>
                </form>
                <a id="cvHashId"></a>
            </td>
        </tr>
        </tbody>
    </table>
</div>

<a href="#" id="registerProfileButtonId" class="btn btn-primary">Create</a>

<br><br><br>

<h1>View Profile</h1>

<div class="table-responsive">
    <table class="table table-bordered">
        <tbody>
        <tr>
            <td>Profile Id</td>
            <td><input type="text" id="profileIdTextId"/></td>
        </tr>
        </tbody>
    </table>
</div>

<a href="#" id="viewProfileButtonId" class="btn btn-primary">View</a>

<div class="table-responsive">
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Employee Code</th>
            <th>Profile Name</th>
            <th>Skills</th>
            <th>CV</th>
            <th>Status</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td id="retrievedProfileEmployeeCodeTextId">code</td>
            <td id="retrievedProfileNameTextId">name</td>
            <td id="retrievedProfileSkillsTextId">skills</td>
            <td id="retrievedProfileCvHashTextId">cv</td>
            <td id="retrievedProfileStatusTextId">status</td>
        </tr>
        </tbody>
    </table>
</div>

<br><br><br>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="lib/bootstrap.min.js"></script>
<script src="lib/web3.min.js"></script>
<script src="lib/truffle-contract.js"></script>
<!--<script src="js/app.js"></script>-->
<script src="js/employee.js"></script>

<script type="text/javascript">

    function upload() {
        console.log("Upload");
        const reader = new FileReader();
        const cv = document.getElementById("cvInputId");
        reader.readAsArrayBuffer(cv.files[0]); // Read Provided File
        reader.onloadend = function() {
            const ipfs = window.IpfsApi('localhost', 5001); // Connect to IPFS
            const buf = buffer.Buffer(reader.result); // Convert data into buffer
            ipfs.files.add(buf, (err, result) => { // Upload buffer to IPFS
                if(err) {
                    console.error(err);
                    return
                }
                let cvHash = result[0].hash;
                console.log(`cvHash: ${cvHash}`);
                $("#cvHashId").text(cvHash);
            })
        };
    }

</script>

</body>

</html>
