

if (typeof web3 !== 'undefined') {
    web3 = new Web3(web3.currentProvider);
} else {
    // set the provider you want from Web3.providers
    web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
}
web3.eth.defaultAccount = web3.eth.accounts[0];


var ProfileContract = web3.eth.contract([
	{
		"constant": true,
		"inputs": [],
		"name": "getprofiles",
		"outputs": [
			{
				"name": "",
				"type": "address[]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"name": "profileList",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_address",
				"type": "address"
			},
			{
				"name": "_hourlyRate",
				"type": "uint256"
			},
			{
				"name": "_description",
				"type": "bytes16"
			},
			{
				"name": "_skill",
				"type": "bytes32[]"
			}
		],
		"name": "setprofile",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "_address",
				"type": "address"
			}
		],
		"name": "getprofile",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			},
			{
				"name": "",
				"type": "bytes16"
			},
			{
				"name": "",
				"type": "bytes32[]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "hourlyRate",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "description",
				"type": "bytes16"
			},
			{
				"indexed": false,
				"name": "skills",
				"type": "bytes32[]"
			}
		],
		"name": "set_profile",
		"type": "event"
	}
]
);


var employee_profile= ProfileContract.at('0xf966aecaf4911ba817c820ea94cc61836e27e889');
// console.log(Coursetro);

var EmpProfileEvent = employee_profile.set_profile({},'latest');
EmpProfileEvent.watch(function (err, result) {
if (!err) {
if (result.blockHash != $("#instrans").html())
    $("#loader").hide();

$("#insTrans").html('Block hash: ' +result.blockHash);
$("#rate").html('0'+result.args.hourlyRate);
$("#description").html(web3.toAscii(result.args.description));

for (var i = 0; i < 5; i++) {

    $("#s"+i).html(web3.toAscii(result.args.skills[i]));
}

} else {
$("#loader").hide();
}
});



$("#update").click(function() {
$("#loader").show();
employee_profile.set_profile(web3.eth.defaultAccount, $("#hourlyRate").val(), $("#description").val(),["java","PHP","javascript"], (err, res) => {
  if (err) {
      $("#loader").hide();
  }
});
});



var EmployeeContract = web3.eth.contract([
	{
		"constant": true,
		"inputs": [
			{
				"name": "_address",
				"type": "address"
			}
		],
		"name": "getEmployee",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			},
			{
				"name": "",
				"type": "bytes16"
			},
			{
				"name": "",
				"type": "bytes16"
			},
			{
				"name": "",
				"type": "bytes32[]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "getEmployees",
		"outputs": [
			{
				"name": "",
				"type": "address[]"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "_address",
				"type": "address"
			},
			{
				"name": "_id",
				"type": "uint256"
			},
			{
				"name": "_fName",
				"type": "bytes16"
			},
			{
				"name": "_lName",
				"type": "bytes16"
			},
			{
				"name": "_skill",
				"type": "bytes32[]"
			}
		],
		"name": "setEmployee",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"name": "EmployeeList",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "id",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "fName",
				"type": "bytes16"
			},
			{
				"indexed": false,
				"name": "lName",
				"type": "bytes16"
			},
			{
				"indexed": false,
				"name": "skills",
				"type": "bytes32[]"
			}
		],
		"name": "employeeReg",
		"type": "event"
	}
]
);
var Employees = EmployeeContract.at('0xa37826ff54c20b3e06bc359fcff5454c8eb536f4');
// console.log(Coursetro);

var EmployeeEvent = Employees.employeeReg({},'latest');
EmployeeEvent.watch(function (err, result) {
if (!err) {
if (result.blockHash != $("#instrans").html())
    $("#loader").hide();

$("#insTrans").html('Block hash: ' +result.blockHash);
$("#emp_id").html('0'+result.args.id);
$("#emp_fn").html(web3.toAscii(result.args.fName));
$("#emp_ln").html(web3.toAscii(result.args.lName));


for (var i = 0; i < 5; i++) {

    $("#s"+i).html(web3.toAscii(result.args.skills[i]));
}

} else {
$("#loader").hide();
}
});



$("#button").click(function() {
$("#loader").show();
Employees.setEmployee(web3.eth.defaultAccount, $("#id").val(), $("#fName").val(), $("#lName").val(),["java","PHP","javascript"], (err, res) => {
  if (err) {
      $("#loader").hide();
  }
});
});
